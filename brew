#!/bin/sh

if [[ ! -f $(which brew) ]]; then
  echo "Homebrew not installed. Installing brew..."
  /bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"
fi

brew update

function install_casks() {
  brew tap homebrew/cask
  brew tap homebrew/cask-fonts

  devTools=(
    'alacritty'
    'visual-studio-code'
    'insomnia'
    'docker'
    'spotify'
  )
  utilities=(
    '1password'
    'google-chrome'
    'brave-browser'
    'inkscape'
    'vlc'
    'notion'
  )
  social=(
    'telegram'
    'tweetbot'
  )
  fonts=(
    'font-fira-code'
    'font-jetbrains-mono'
  )
  all=(
    "${devTools[@]}"
    "${utilities[@]}"
    "${social[@]}"
    "${fonts[@]}"
  )

  for i in "${all[@]}"; do
    brew install --cask "$i"
  done
}

function install_gnu_utils() {
  brew install gnu-sed # patches sed to be unix compatible

  # Replaces standard Mac OS X utilities with GNU core utilities List of all commands can be found
  # here: https://en.wikipedia.org/wiki/List_of_GNU_Core_Utilities_commands Initially available with
  # 'g' prefix (grm, gmv etc.)
  brew install coreutils

  # Extending directory search and file locating capabilities https://www.gnu.org/software/findutils/
  brew install findutils
}

function install_formulas() {
  devUtils=(
    'git'
    'gh'  #github cli
    'svn' # svn isn't shipped with XCode by default anymore
    'python3'
    'bat' # colorful cat
    'docker-compose'
    'neovim'
    'tmux',
    'asdf' # runtime version manager
  )

  for i in "${devUtils[@]}"; do
    brew install "$i"
  done

  utils=(
    'p7zip' # 7zip archiver
    # Use to convert & minimize video quality like: ffmpeg -i input.mov -vcodec libx265 -crf 28 output.mp4
    'ffmpeg'
    # Improves git diff https://github.com/so-fancy/diff-so-fancy gitconfig should be additionally
    # configured to apply it for every diff.
    'diff-so-fancy'
  )

  for i in "${utils[@]}"; do
    brew install "$i"
  done

  # Installing yarn without global node dependency
  # https://gist.github.com/AGutierrezR/2c22fdd8686e6e30c56949f5e37e214e
  brew install yarn --ignore-dependencies

  # fzf is a general-purpose command-line fuzzy finder.
  brew install fzf
  $(brew --prefix)/opt/fzf/install
}

install_formulas
install_gnu_utils
install_casks
